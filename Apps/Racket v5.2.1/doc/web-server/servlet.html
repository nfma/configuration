<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text-html; charset=utf-8" /><title>2&nbsp;Stateful Servlets</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default" /><link rel="stylesheet" type="text/css" href="../racket.css" title="default" /><link rel="stylesheet" type="text/css" href="../scribble-style.css" title="default" /><script type="text/javascript" src="../scribble-common.js"></script></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist" style="margin-bottom: 1em;"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" pltdoc="x">Web Applications in Racket</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="run.html" class="tocviewlink" pltdoc="x">Running Web Servlets</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="" class="tocviewselflink" pltdoc="x">Stateful Servlets</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="stateless.html" class="tocviewlink" pltdoc="x">Stateless Servlets</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="http.html" class="tocviewlink" pltdoc="x">HTTP:<span class="mywbr"> </span> Hypertext Transfer Protocol</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="dispatch.html" class="tocviewlink" pltdoc="x">URL-<wbr></wbr>Based Dispatch</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="formlets.html" class="tocviewlink" pltdoc="x">Formlets:<span class="mywbr"> </span> Functional Form Abstraction</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="templates.html" class="tocviewlink" pltdoc="x">Templates:<span class="mywbr"> </span> Separation of View</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="page.html" class="tocviewlink" pltdoc="x">Page:<span class="mywbr"> </span> Short-<wbr></wbr>hand for Common Patterns</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="test.html" class="tocviewlink" pltdoc="x">Testing Servlets</a></td></tr><tr><td align="right">10&nbsp;</td><td><a href="faq.html" class="tocviewlink" pltdoc="x">Troubleshooting and Tips</a></td></tr><tr><td align="right"></td><td><a href="doc-index.html" class="tocviewlink" pltdoc="x">Index</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>2&nbsp;</td><td><a href="" class="tocviewselflink" pltdoc="x">Stateful Servlets</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">2.1&nbsp;</td><td><a href="#(part._servlet-example)" class="tocviewlink" pltdoc="x">Example</a></td></tr><tr><td align="right">2.2&nbsp;</td><td><a href="#(part._servlet-structs)" class="tocviewlink" pltdoc="x">Responses</a></td></tr><tr><td align="right">2.3&nbsp;</td><td><a href="#(part._web)" class="tocviewlink" pltdoc="x">Web Interaction</a></td></tr><tr><td align="right">2.4&nbsp;</td><td><a href="#(part._web-cells)" class="tocviewlink" pltdoc="x">Web Cells</a></td></tr><tr><td align="right">2.5&nbsp;</td><td><a href="#(part._managers)" class="tocviewlink" pltdoc="x">Continuation Managers</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">2.1<tt>&nbsp;</tt></span><a href="#(part._servlet-example)" class="tocsubseclink" pltdoc="x">Example</a></td></tr><tr><td><a href="#(def._((lib._web-server/scribblings/dummy-v2-servlet..rkt)._interface-version))" class="tocsubnonseclink" pltdoc="x"><span class="RktSym"><span class="RktValLink">interface-<wbr></wbr>version</span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/scribblings/dummy-v2-servlet..rkt)._manager))" class="tocsubnonseclink" pltdoc="x"><span class="RktSym"><span class="RktValLink">manager</span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/scribblings/dummy-v2-servlet..rkt)._start))" class="tocsubnonseclink" pltdoc="x"><span class="RktSym"><span class="RktValLink">start</span></span></a></td></tr><tr><td><span class="tocsublinknumber">2.2<tt>&nbsp;</tt></span><a href="#(part._servlet-structs)" class="tocsubseclink" pltdoc="x">Responses</a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/servlet-structs"><span class="RktSym"><span class="RktValLink">can-<wbr></wbr>be-<wbr></wbr>response?</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._any-~3eresponse))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/servlet-structs"><span class="RktSym"><span class="RktValLink">any-<wbr></wbr>&gt;response</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._set-any-~3eresponse!))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/servlet-structs"><span class="RktSym"><span class="RktValLink">set-<wbr></wbr>any-<wbr></wbr>&gt;response!</span></span></span></a></td></tr><tr><td><span class="tocsublinknumber">2.3<tt>&nbsp;</tt></span><a href="#(part._web)" class="tocsubseclink" pltdoc="x">Web Interaction</a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web..rkt)._send/back))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web"><span class="RktSym"><span class="RktValLink">send/<span class="mywbr"> </span>back</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web"><span class="RktSym"><span class="RktValLink">send/<span class="mywbr"> </span>suspend</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend/url))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web"><span class="RktSym"><span class="RktValLink">send/<span class="mywbr"> </span>suspend/<span class="mywbr"> </span>url</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend/dispatch))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web"><span class="RktSym"><span class="RktValLink">send/<span class="mywbr"> </span>suspend/<span class="mywbr"> </span>dispatch</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend/url/dispatch))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web"><span class="RktSym"><span class="RktValLink">send/<span class="mywbr"> </span>suspend/<span class="mywbr"> </span>url/<span class="mywbr"> </span>dispatch</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web..rkt)._send/forward))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web"><span class="RktSym"><span class="RktValLink">send/<span class="mywbr"> </span>forward</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web..rkt)._send/finish))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web"><span class="RktSym"><span class="RktValLink">send/<span class="mywbr"> </span>finish</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web..rkt)._redirect/get))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web"><span class="RktSym"><span class="RktValLink">redirect/<span class="mywbr"> </span>get</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web..rkt)._redirect/get/forget))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web"><span class="RktSym"><span class="RktValLink">redirect/<span class="mywbr"> </span>get/<span class="mywbr"> </span>forget</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web..rkt)._current-servlet-continuation-expiration-handler))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web"><span class="RktSym"><span class="RktValLink">current-<wbr></wbr>servlet-<wbr></wbr>continuation-<wbr></wbr>expiration-<wbr></wbr>handler</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web..rkt)._clear-continuation-table!))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web"><span class="RktSym"><span class="RktValLink">clear-<wbr></wbr>continuation-<wbr></wbr>table!</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web..rkt)._with-errors-to-browser))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web"><span class="RktSym"><span class="RktValLink">with-<wbr></wbr>errors-<wbr></wbr>to-<wbr></wbr>browser</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web..rkt)._adjust-timeout!))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web"><span class="RktSym"><span class="RktValLink">adjust-<wbr></wbr>timeout!</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web..rkt)._continuation-url~3f))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web"><span class="RktSym"><span class="RktValLink">continuation-<wbr></wbr>url?</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web..rkt)._servlet-prompt))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web"><span class="RktSym"><span class="RktValLink">servlet-<wbr></wbr>prompt</span></span></span></a></td></tr><tr><td><span class="tocsublinknumber">2.4<tt>&nbsp;</tt></span><a href="#(part._web-cells)" class="tocsubseclink" pltdoc="x">Web Cells</a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web-cells..rkt)._web-cell~3f))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web-cells"><span class="RktSym"><span class="RktValLink">web-<wbr></wbr>cell?</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web-cells..rkt)._make-web-cell))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web-cells"><span class="RktSym"><span class="RktValLink">make-<wbr></wbr>web-<wbr></wbr>cell</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web-cells..rkt)._web-cell-ref))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web-cells"><span class="RktSym"><span class="RktValLink">web-<wbr></wbr>cell-<wbr></wbr>ref</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/servlet/web-cells..rkt)._web-cell-shadow))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/servlet/web-cells"><span class="RktSym"><span class="RktValLink">web-<wbr></wbr>cell-<wbr></wbr>shadow</span></span></span></a></td></tr><tr><td><span class="tocsublinknumber">2.5<tt>&nbsp;</tt></span><a href="#(part._managers)" class="tocsubseclink" pltdoc="x">Continuation Managers</a></td></tr><tr><td><span class="tocsublinknumber">2.5.1<tt>&nbsp;</tt></span><a href="#(part._manager)" class="tocsubseclink" pltdoc="x">General</a></td></tr><tr><td><a href="#(def._((lib._web-server/managers/manager..rkt)._manager))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/managers/manager"><span class="RktSym"><span class="RktValLink">manager</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/managers/manager..rkt)._exn~3afail~3aservlet-manager~3ano-instance))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/managers/manager"><span class="RktSym"><span class="RktValLink">exn:<span class="mywbr"> </span>fail:<span class="mywbr"> </span>servlet-<wbr></wbr>manager:<span class="mywbr"> </span>no-<wbr></wbr>instance</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/managers/manager..rkt)._exn~3afail~3aservlet-manager~3ano-continuation))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/managers/manager"><span class="RktSym"><span class="RktValLink">exn:<span class="mywbr"> </span>fail:<span class="mywbr"> </span>servlet-<wbr></wbr>manager:<span class="mywbr"> </span>no-<wbr></wbr>continuation</span></span></span></a></td></tr><tr><td><span class="tocsublinknumber">2.5.2<tt>&nbsp;</tt></span><a href="#(part._none)" class="tocsubseclink" pltdoc="x">No Continuations</a></td></tr><tr><td><a href="#(def._((lib._web-server/managers/none..rkt)._create-none-manager))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/managers/none"><span class="RktSym"><span class="RktValLink">create-<wbr></wbr>none-<wbr></wbr>manager</span></span></span></a></td></tr><tr><td><span class="tocsublinknumber">2.5.3<tt>&nbsp;</tt></span><a href="#(part._timeouts)" class="tocsubseclink" pltdoc="x">Timeouts</a></td></tr><tr><td><a href="#(def._((lib._web-server/managers/timeouts..rkt)._create-timeout-manager))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/managers/timeouts"><span class="RktSym"><span class="RktValLink">create-<wbr></wbr>timeout-<wbr></wbr>manager</span></span></span></a></td></tr><tr><td><span class="tocsublinknumber">2.5.4<tt>&nbsp;</tt></span><a href="#(part._lru)" class="tocsubseclink" pltdoc="x">LRU</a></td></tr><tr><td><a href="#(def._((lib._web-server/managers/lru..rkt)._create-.L.R.U-manager))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/managers/lru"><span class="RktSym"><span class="RktValLink">create-<wbr></wbr>LRU-<wbr></wbr>manager</span></span></span></a></td></tr><tr><td><a href="#(def._((lib._web-server/managers/lru..rkt)._make-threshold-.L.R.U-manager))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: web-server/managers/lru"><span class="RktSym"><span class="RktValLink">make-<wbr></wbr>threshold-<wbr></wbr>LRU-<wbr></wbr>manager</span></span></span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;5.2.1&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }" /></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" pltdoc="x" onclick="return GotoPLTRoot(&quot;5.2.1&quot;);">top</a></span><span class="navright"><a href="run.html" title="backward to &quot;1 Running Web Servlets&quot;" pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Web Applications in Racket&quot;" pltdoc="x">up</a>&nbsp;&nbsp;<a href="stateless.html" title="forward to &quot;3 Stateless Servlets&quot;" pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>2<tt>&nbsp;</tt><a name="(part._servlet)"></a><a name="(mod-path._web-server/servlet)"></a>Stateful Servlets</h3><p><table cellspacing="0" class="defmodule"><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="RktStxLink" pltdoc="x">require</a></span><span class="stt"> </span><a href="" class="RktModLink" pltdoc="x"><span class="RktSym">web-server/servlet</span></a><span class="RktPn">)</span></td></tr></table></p><a name="(part._servlet-example)"></a><p>A stateful servlet should <span class="RktSym"><a href="../reference/require.html#(form._((lib._racket/private/base..rkt)._provide))" class="RktStxLink" pltdoc="x">provide</a></span> the following exports:</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><a name="(def._((lib._web-server/scribblings/dummy-v2-servlet..rkt)._interface-version))"></a><span class="RktSym"><a href="#(def._((lib._web-server/scribblings/dummy-v2-servlet..rkt)._interface-version))" class="RktValLink" pltdoc="x">interface-version</a></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._one-of/c))" class="RktValLink" pltdoc="x">one-of/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">v2</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">This indicates that the servlet is a version two servlet.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><a name="(def._((lib._web-server/scribblings/dummy-v2-servlet..rkt)._manager))"></a><span class="RktSym"><a href="#(def._((lib._web-server/scribblings/dummy-v2-servlet..rkt)._manager))" class="RktValLink" pltdoc="x">manager</a></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/managers/manager..rkt)._manager~3f))" class="RktValLink" pltdoc="x">manager?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">The manager for the continuations of this servlet. See <a href="#(part._managers)" pltdoc="x">Continuation Managers</a> for options.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/scribblings/dummy-v2-servlet..rkt)._start))"></a><span class="RktSym"><a href="#(def._((lib._web-server/scribblings/dummy-v2-servlet..rkt)._start))" class="RktValLink" pltdoc="x">start</a></span><span class="hspace">&nbsp;</span><span class="RktVar">initial-request</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym">can-be-response?</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">initial-request</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/request-structs..rkt)._request~3f))" class="RktValLink" pltdoc="x">request?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">This function is called when an instance of this servlet is started.
The argument is the HTTP request that initiated the instance.</div></p><p>An example version 2 module:</p><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><a href="../guide/Module_Syntax.html#(part._hash-lang)" class="RktModLink" pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="../reference/index.html" class="RktModLink" pltdoc="x"><span class="RktSym">racket</span></a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="RktStxLink" pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">web-server/managers/none</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/require.html#(form._((lib._racket/private/base..rkt)._provide))" class="RktStxLink" pltdoc="x">provide</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/scribblings/dummy-v2-servlet..rkt)._interface-version))" class="RktValLink" pltdoc="x">interface-version</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/scribblings/dummy-v2-servlet..rkt)._manager))" class="RktValLink" pltdoc="x">manager</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/scribblings/dummy-v2-servlet..rkt)._start))" class="RktValLink" pltdoc="x">start</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/scribblings/dummy-v2-servlet..rkt)._interface-version))" class="RktValLink" pltdoc="x">interface-version</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">v2</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/scribblings/dummy-v2-servlet..rkt)._manager))" class="RktValLink" pltdoc="x">manager</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._web-server/managers/none..rkt)._create-none-manager))" class="RktValLink" pltdoc="x">create-none-manager</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">req</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/xexpr..rkt)._response/xexpr))" class="RktValLink" pltdoc="x">response/xexpr</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">`</span><span class="RktVal">(</span><span class="RktVal">html</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">head</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">title</span><span class="hspace">&nbsp;</span><span class="RktVal">"No Continuations Here!"</span><span class="RktVal">)</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">body</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">h1</span><span class="hspace">&nbsp;</span><span class="RktVal">"No Continuations Here!"</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._web-server/scribblings/dummy-v2-servlet..rkt)._start))" class="RktValLink" pltdoc="x">start</a></span><span class="hspace">&nbsp;</span><span class="RktSym">req</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/xexpr..rkt)._response/xexpr))" class="RktValLink" pltdoc="x">response/xexpr</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktVal">`</span><span class="RktVal">(</span><span class="RktVal">html</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">head</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">title</span><span class="hspace">&nbsp;</span><span class="RktVal">"Hello World!"</span><span class="RktVal">)</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">body</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">h1</span><span class="hspace">&nbsp;</span><span class="RktVal">"Hi Mom!"</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p>These servlets have an extensive API available to them: <a href="../net/url.html" class="RktModLink" pltdoc="x"><span class="RktSym">net/url</span></a>, <a href="http.html" class="RktModLink" pltdoc="x"><span class="RktSym">web-server/http</span></a>,
      <a href="http.html#(mod-path._web-server/http/bindings)" class="RktModLink" pltdoc="x"><span class="RktSym">web-server/http/bindings</span></a>, <a href="#(mod-path._web-server/servlet/servlet-structs)" class="RktModLink" pltdoc="x"><span class="RktSym">web-server/servlet/servlet-structs</span></a>, <a href="#(mod-path._web-server/servlet/web)" class="RktModLink" pltdoc="x"><span class="RktSym">web-server/servlet/web</span></a>,
      <a href="#(mod-path._web-server/servlet/web-cells)" class="RktModLink" pltdoc="x"><span class="RktSym">web-server/servlet/web-cells</span></a>, and <a href="dispatch.html" class="RktModLink" pltdoc="x"><span class="RktSym">web-server/dispatch</span></a>.
      Some of these are documented in the subsections that follow.</p><h4>2.2<tt>&nbsp;</tt><a name="(part._servlet-structs)"></a><a name="(mod-path._web-server/servlet/servlet-structs)"></a>Responses</h4><p><div class="SIntrapara"><table cellspacing="0" class="defmodule"><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="RktStxLink" pltdoc="x">require</a></span><span class="stt"> </span><a href="#(mod-path._web-server/servlet/servlet-structs)" class="RktModLink" pltdoc="x"><span class="RktSym">web-server/servlet/servlet-structs</span></a><span class="RktPn">)</span></td></tr></table></div><div class="SIntrapara">Servlets communicate to the Web Server by returning HTTP responses. In order to
accommodate lightweight programs (and backwards compatibility), the Web Server
provides an indirection from application-specific response formats and the internal
HTTP response format, <span class="RktSym"><a href="http.html#(def._((lib._web-server/http/response-structs..rkt)._response))" class="RktValLink" pltdoc="x">response</a></span>.</div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><table cellspacing="0" class="together"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))"></a><span title="Provided from: web-server/servlet/servlet-structs"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/booleans.html#(def._((quote._~23~25kernel)._boolean~3f))" class="RktValLink" pltdoc="x">boolean?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr></table></td></tr><tr><td><table cellspacing="0" class="together"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/servlet-structs..rkt)._any-~3eresponse))"></a><span title="Provided from: web-server/servlet/servlet-structs"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._any-~3eresponse))" class="RktValLink" pltdoc="x">any-&gt;response</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._false/c))" class="RktValLink" pltdoc="x">false/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/response-structs..rkt)._response~3f))" class="RktValLink" pltdoc="x">response?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr></table></td></tr><tr><td><table cellspacing="0" class="together"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/servlet-structs..rkt)._set-any-~3eresponse!))"></a><span title="Provided from: web-server/servlet/servlet-structs"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._set-any-~3eresponse!))" class="RktValLink" pltdoc="x">set-any-&gt;response!</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">new-any-&gt;response</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/void.html#(def._((quote._~23~25kernel)._void))" class="RktValLink" pltdoc="x">void</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">new-any-&gt;response</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._false/c))" class="RktValLink" pltdoc="x">false/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/response-structs..rkt)._response~3f))" class="RktValLink" pltdoc="x">response?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._any-~3eresponse))" class="RktValLink" pltdoc="x">any-&gt;response</a></span> coerces any value into a response or returns <span class="RktVal">#f</span> if coercion is not possible.
<span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._any-~3eresponse))" class="RktValLink" pltdoc="x">any-&gt;response</a></span> guarantees that any <span class="RktSym"><a href="http.html#(def._((lib._web-server/http/response-structs..rkt)._response~3f))" class="RktValLink" pltdoc="x">response?</a></span> input must always be returned exactly (i.e. <span class="RktSym"><a href="../reference/booleans.html#(def._((quote._~23~25kernel)._eq~3f))" class="RktValLink" pltdoc="x">eq?</a></span>.)
The default always returns <span class="RktVal">#f</span>, signifying that no coercion is possible.</div></p></div><div class="SIntrapara"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span> returns <span class="RktVal">#t</span> if <span class="RktVar">x</span> is a response or can be turned into a response by calling
<span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._any-~3eresponse))" class="RktValLink" pltdoc="x">any-&gt;response</a></span>.</div><div class="SIntrapara">Users of <span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._any-~3eresponse))" class="RktValLink" pltdoc="x">any-&gt;response</a></span> should protect themselves by using <span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span> as a contract.
If they do so, they can safely ignore the <span class="RktVal">#f</span> return case of <span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._any-~3eresponse))" class="RktValLink" pltdoc="x">any-&gt;response</a></span>.</div><div class="SIntrapara"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._set-any-~3eresponse!))" class="RktValLink" pltdoc="x">set-any-&gt;response!</a></span> replaces the global <span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._any-~3eresponse))" class="RktValLink" pltdoc="x">any-&gt;response</a></span> with the supplied argument. This
function should return the same value for <span class="RktSym"><a href="../reference/booleans.html#(def._((quote._~23~25kernel)._eq~3f))" class="RktValLink" pltdoc="x">eq?</a></span> inputs to ensure that <span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span> is
any accurate predicate. Similarly, this function should be cheap to call multiple times on the same input,
since it will be used in contract checking as well as coercion before transmission. You may want to use a
weak <span class="RktSym"><a href="../reference/booleans.html#(def._((quote._~23~25kernel)._eq~3f))" class="RktValLink" pltdoc="x">eq?</a></span>-based hash-table to cache the results for this purpose. (See <span class="RktSym"><a href="../reference/hashtables.html#(def._((quote._~23~25kernel)._make-weak-hasheq))" class="RktValLink" pltdoc="x">make-weak-hasheq</a></span>.)</div></p><h4>2.3<tt>&nbsp;</tt><a name="(part._web)"></a><a name="(mod-path._web-server/servlet/web)"></a>Web Interaction</h4><p><div class="SIntrapara"><table cellspacing="0" class="defmodule"><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="RktStxLink" pltdoc="x">require</a></span><span class="stt"> </span><a href="#(mod-path._web-server/servlet/web)" class="RktModLink" pltdoc="x"><span class="RktSym">web-server/servlet/web</span></a><span class="RktPn">)</span></td></tr></table></div><div class="SIntrapara">The
<a href="#(mod-path._web-server/servlet/web)" class="RktModLink" pltdoc="x"><span class="RktSym">web-server/servlet/web</span></a> library provides the primary
functions of interest for the servlet developer.</div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/web..rkt)._send/back))"></a><span title="Provided from: web-server/servlet/web"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/back))" class="RktValLink" pltdoc="x">send/back</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">response</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/void.html#(def._((quote._~23~25kernel)._void~3f))" class="RktValLink" pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">response</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Sends <span class="RktVar">response</span> to the client. No continuation is captured, so the servlet is done.</div></p></div><div class="SIntrapara"><p><div class="SIntrapara">Example:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/back))" class="RktValLink" pltdoc="x">send/back</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/xexpr..rkt)._response/xexpr))" class="RktValLink" pltdoc="x">response/xexpr</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">`</span><span class="RktVal">(</span><span class="RktVal">html</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">body</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">h1</span><span class="hspace">&nbsp;</span><span class="RktVal">"The sum is: "</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">,</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/generic-numbers.html#(def._((quote._~23~25kernel)._+))" class="RktValLink" pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">first-number</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">second-number</span><span class="RktPn">)</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p></div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/web..rkt)._send/suspend))"></a><span title="Provided from: web-server/servlet/web"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend))" class="RktValLink" pltdoc="x">send/suspend</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">make-response</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/request-structs..rkt)._request~3f))" class="RktValLink" pltdoc="x">request?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">make-response</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/strings.html#(def._((quote._~23~25kernel)._string~3f))" class="RktValLink" pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Captures the current continuation, stores it with <span class="RktSym"><a href="../reference/generic-numbers.html#(def._((quote._~23~25kernel)._exp))" class="RktValLink" pltdoc="x">exp</a></span> as the expiration
handler, and binds it to a URL. <span class="RktVar">make-response</span> is called with this URL and
is expected to generate a <span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span>, which is sent to the client. If the
continuation URL is invoked, the captured continuation is invoked and the request is
returned from this call to <span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend))" class="RktValLink" pltdoc="x">send/suspend</a></span>.</div></p></div><div class="SIntrapara"><p><div class="SIntrapara">Example:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend))" class="RktValLink" pltdoc="x">send/suspend</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">k-url</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/xexpr..rkt)._response/xexpr))" class="RktValLink" pltdoc="x">response/xexpr</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">`</span><span class="RktVal">(</span><span class="RktVal">html</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">head</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">title</span><span class="hspace">&nbsp;</span><span class="RktVal">"Enter a number"</span><span class="RktVal">)</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">body</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">form</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">[</span><span class="RktVal">action</span><span class="hspace">&nbsp;</span><span class="RktRdr">,</span><span class="RktSym">k-url</span><span class="RktVal">]</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"Enter a number: "</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">input</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">[</span><span class="RktVal">name</span><span class="hspace">&nbsp;</span><span class="RktVal">"number"</span><span class="RktVal">]</span><span class="RktVal">)</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">input</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">[</span><span class="RktVal">type</span><span class="hspace">&nbsp;</span><span class="RktVal">"submit"</span><span class="RktVal">]</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p></div><div class="SIntrapara">When this form is submitted by the browser, the request will be sent to the URL generated by <span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend))" class="RktValLink" pltdoc="x">send/suspend</a></span>.
Thus, the request will be &ldquo;returned&rdquo; from <span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend))" class="RktValLink" pltdoc="x">send/suspend</a></span> to the continuation of this call.</div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/web..rkt)._send/suspend/url))"></a><span title="Provided from: web-server/servlet/web"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend/url))" class="RktValLink" pltdoc="x">send/suspend/url</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">make-response</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/request-structs..rkt)._request~3f))" class="RktValLink" pltdoc="x">request?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">make-response</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../net/url.html#(def._((lib._net/url-structs..rkt)._url~3f))" class="RktValLink" pltdoc="x">url?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend))" class="RktValLink" pltdoc="x">send/suspend</a></span> but with a URL struct.</div></p></div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/web..rkt)._send/suspend/dispatch))"></a><span title="Provided from: web-server/servlet/web"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend/dispatch))" class="RktValLink" pltdoc="x">send/suspend/dispatch</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">make-response</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(form._((lib._racket/contract/private/misc..rkt)._any))" class="RktStxLink" pltdoc="x">any</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">make-response</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/request-structs..rkt)._request~3f))" class="RktValLink" pltdoc="x">request?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(form._((lib._racket/contract/private/misc..rkt)._any))" class="RktStxLink" pltdoc="x">any</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/strings.html#(def._((quote._~23~25kernel)._string~3f))" class="RktValLink" pltdoc="x">string?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Calls <span class="RktVar">make-response</span> with a function (<span class="RktSym">embed/url</span>) that, when called with a procedure from
<span class="RktSym"><a href="http.html#(def._((lib._web-server/http/request-structs..rkt)._request~3f))" class="RktValLink" pltdoc="x">request?</a></span> to <span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span> will generate a URL, that when invoked will call
the function with the <span class="RktSym"><a href="http.html#(def._((lib._web-server/http/request-structs..rkt)._request~3f))" class="RktValLink" pltdoc="x">request?</a></span> object and return the result to the caller of
<span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend/dispatch))" class="RktValLink" pltdoc="x">send/suspend/dispatch</a></span>. Therefore, if you pass <span class="RktSym">embed/url</span> the identity function,
<span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend/dispatch))" class="RktValLink" pltdoc="x">send/suspend/dispatch</a></span> devolves into <span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend))" class="RktValLink" pltdoc="x">send/suspend</a></span>:</div></p></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend))" class="RktValLink" pltdoc="x">send/suspend</a></span><span class="hspace">&nbsp;</span><span class="RktSym">response-generator</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend/dispatch))" class="RktValLink" pltdoc="x">send/suspend/dispatch</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">embed/url</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">response-generator</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">embed/url</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara"><p><div class="SIntrapara">Use <span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend/dispatch))" class="RktValLink" pltdoc="x">send/suspend/dispatch</a></span> when there are multiple `logical&rsquo; continuations of a page.
For example, we could either add to a number or subtract from it:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">count-dot-com</span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">count-dot-com</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend/dispatch))" class="RktValLink" pltdoc="x">send/suspend/dispatch</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">embed/url</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/xexpr..rkt)._response/xexpr))" class="RktValLink" pltdoc="x">response/xexpr</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">`</span><span class="RktVal">(</span><span class="RktVal">html</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">head</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">title</span><span class="hspace">&nbsp;</span><span class="RktVal">"Count!"</span><span class="RktVal">)</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">body</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">h2</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">[</span><span class="RktVal">href</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">,</span><span class="RktPn">(</span><span class="RktSym">embed/url</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">req</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/generic-numbers.html#(def._((quote._~23~25kernel)._sub1))" class="RktValLink" pltdoc="x">sub1</a></span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktVal">]</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"-"</span><span class="RktVal">)</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">h1</span><span class="hspace">&nbsp;</span><span class="RktRdr">,</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/generic-numbers.html#(def._((quote._~23~25kernel)._number-~3estring))" class="RktValLink" pltdoc="x">number-&gt;string</a></span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="RktPn">)</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">h2</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">[</span><span class="RktVal">href</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">,</span><span class="RktPn">(</span><span class="RktSym">embed/url</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">req</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/generic-numbers.html#(def._((quote._~23~25kernel)._add1))" class="RktValLink" pltdoc="x">add1</a></span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktVal">]</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"+"</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Notice that in this example the result of the handlers are returned to the continuation of <span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend/dispatch))" class="RktValLink" pltdoc="x">send/suspend/dispatch</a></span>.
However, it is very common that the return value of <span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend/dispatch))" class="RktValLink" pltdoc="x">send/suspend/dispatch</a></span> is irrelevant in
your application and you may think of it as &ldquo;embedding&rdquo; value-less callbacks. Here is the same example in this style:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">count-dot-com</span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend/dispatch))" class="RktValLink" pltdoc="x">send/suspend/dispatch</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">embed/url</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/xexpr..rkt)._response/xexpr))" class="RktValLink" pltdoc="x">response/xexpr</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">`</span><span class="RktVal">(</span><span class="RktVal">html</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">head</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">title</span><span class="hspace">&nbsp;</span><span class="RktVal">"Count!"</span><span class="RktVal">)</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">body</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">h2</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">[</span><span class="RktVal">href</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">,</span><span class="RktPn">(</span><span class="RktSym">embed/url</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">req</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">count-dot-com</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/generic-numbers.html#(def._((quote._~23~25kernel)._sub1))" class="RktValLink" pltdoc="x">sub1</a></span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktVal">]</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"-"</span><span class="RktVal">)</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">h1</span><span class="hspace">&nbsp;</span><span class="RktRdr">,</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/generic-numbers.html#(def._((quote._~23~25kernel)._number-~3estring))" class="RktValLink" pltdoc="x">number-&gt;string</a></span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="RktPn">)</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">h2</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">[</span><span class="RktVal">href</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">,</span><span class="RktPn">(</span><span class="RktSym">embed/url</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">req</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">count-dot-com</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/generic-numbers.html#(def._((quote._~23~25kernel)._add1))" class="RktValLink" pltdoc="x">add1</a></span><span class="hspace">&nbsp;</span><span class="RktSym">i</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktVal">]</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"+"</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p></div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/web..rkt)._send/suspend/url/dispatch))"></a><span title="Provided from: web-server/servlet/web"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend/url/dispatch))" class="RktValLink" pltdoc="x">send/suspend/url/dispatch</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">make-response</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(form._((lib._racket/contract/private/misc..rkt)._any))" class="RktStxLink" pltdoc="x">any</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">make-response</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/request-structs..rkt)._request~3f))" class="RktValLink" pltdoc="x">request?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(form._((lib._racket/contract/private/misc..rkt)._any))" class="RktStxLink" pltdoc="x">any</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../net/url.html#(def._((lib._net/url-structs..rkt)._url~3f))" class="RktValLink" pltdoc="x">url?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Like <span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend/dispatch))" class="RktValLink" pltdoc="x">send/suspend/dispatch</a></span>, but with a URL struct.</div></p></div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/web..rkt)._send/forward))"></a><span title="Provided from: web-server/servlet/web"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/forward))" class="RktValLink" pltdoc="x">send/forward</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">make-response</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/request-structs..rkt)._request~3f))" class="RktValLink" pltdoc="x">request?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">make-response</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/strings.html#(def._((quote._~23~25kernel)._string~3f))" class="RktValLink" pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Calls <span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._clear-continuation-table!))" class="RktValLink" pltdoc="x">clear-continuation-table!</a></span>, then <span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend))" class="RktValLink" pltdoc="x">send/suspend</a></span>.</div></p></div><div class="SIntrapara">Use this if the user can logically go `forward&rsquo; in your application, but cannot go backward.</div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/web..rkt)._send/finish))"></a><span title="Provided from: web-server/servlet/web"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/finish))" class="RktValLink" pltdoc="x">send/finish</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">response</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/void.html#(def._((quote._~23~25kernel)._void~3f))" class="RktValLink" pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">response</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Calls <span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._clear-continuation-table!))" class="RktValLink" pltdoc="x">clear-continuation-table!</a></span>, then <span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/back))" class="RktValLink" pltdoc="x">send/back</a></span>.</div></p></div><div class="SIntrapara"><p><div class="SIntrapara">Use this if the user is truly `done&rsquo; with your application. For example, it may be used to display the post-logout page:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/finish))" class="RktValLink" pltdoc="x">send/finish</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/xexpr..rkt)._response/xexpr))" class="RktValLink" pltdoc="x">response/xexpr</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">`</span><span class="RktVal">(</span><span class="RktVal">html</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">head</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">title</span><span class="hspace">&nbsp;</span><span class="RktVal">"Logged out"</span><span class="RktVal">)</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">body</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">p</span><span class="hspace">&nbsp;</span><span class="RktVal">"Thank you for using the services "</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"of the Add Two Numbers, Inc."</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p></div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/web..rkt)._redirect/get))"></a><span title="Provided from: web-server/servlet/web"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._redirect/get))" class="RktValLink" pltdoc="x">redirect/get</a></span></span><span class="hspace">&nbsp;</span>[<span class="RktPn">#:headers</span><span class="hspace">&nbsp;</span><span class="RktVar">hs</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/request-structs..rkt)._request~3f))" class="RktValLink" pltdoc="x">request?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">hs</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._listof))" class="RktValLink" pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/request-structs..rkt)._header~3f))" class="RktValLink" pltdoc="x">header?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/pairs.html#(def._((lib._racket/list..rkt)._empty))" class="RktValLink" pltdoc="x">empty</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Calls <span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend))" class="RktValLink" pltdoc="x">send/suspend</a></span> with <span class="RktSym"><a href="http.html#(def._((lib._web-server/http/redirect..rkt)._redirect-to))" class="RktValLink" pltdoc="x">redirect-to</a></span>, passing <span class="RktVar">hs</span> as the headers.</div></p></div><div class="SIntrapara">This implements the Post-Redirect-Get pattern.
Use this to prevent the <span style="font-family: sans-serif; font-size: 80%; font-weight: bold">Refresh</span> button from duplicating effects, such as adding items to a database.</div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/web..rkt)._redirect/get/forget))"></a><span title="Provided from: web-server/servlet/web"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._redirect/get/forget))" class="RktValLink" pltdoc="x">redirect/get/forget</a></span></span><span class="hspace">&nbsp;</span>[<span class="RktPn">#:headers</span><span class="hspace">&nbsp;</span><span class="RktVar">hs</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/request-structs..rkt)._request~3f))" class="RktValLink" pltdoc="x">request?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">hs</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._listof))" class="RktValLink" pltdoc="x">listof</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/request-structs..rkt)._header~3f))" class="RktValLink" pltdoc="x">header?</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/pairs.html#(def._((lib._racket/list..rkt)._empty))" class="RktValLink" pltdoc="x">empty</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Calls <span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/forward))" class="RktValLink" pltdoc="x">send/forward</a></span> with <span class="RktSym"><a href="http.html#(def._((lib._web-server/http/redirect..rkt)._redirect-to))" class="RktValLink" pltdoc="x">redirect-to</a></span>, passing <span class="RktVar">hs</span> as the headers.</div></p></div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><table cellspacing="0" class="argcontract"><tr><td><a name="(def._((lib._web-server/servlet/web..rkt)._current-servlet-continuation-expiration-handler))"></a><span title="Provided from: web-server/servlet/web"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._current-servlet-continuation-expiration-handler))" class="RktValLink" pltdoc="x">current-servlet-continuation-expiration-handler</a></span></span></td><td><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._parameter/c))" class="RktValLink" pltdoc="x">parameter/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._false/c))" class="RktValLink" pltdoc="x">false/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/request-structs..rkt)._request~3f))" class="RktValLink" pltdoc="x">request?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Holds the expiration handler to be used when a continuation
captured in this context is expired, then looked up.</div></p></div><div class="SIntrapara"><p><div class="SIntrapara">Example:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/parameters.html#(form._((lib._racket/private/more-scheme..rkt)._parameterize))" class="RktStxLink" pltdoc="x">parameterize</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._current-servlet-continuation-expiration-handler))" class="RktValLink" pltdoc="x">current-servlet-continuation-expiration-handler</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">req</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/xexpr..rkt)._response/xexpr))" class="RktValLink" pltdoc="x">response/xexpr</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">`</span><span class="RktVal">(</span><span class="RktVal">html</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">head</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">title</span><span class="hspace">&nbsp;</span><span class="RktVal">"Custom Expiration!"</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend))" class="RktValLink" pltdoc="x">send/suspend</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym">....</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p></div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/web..rkt)._clear-continuation-table!))"></a><span title="Provided from: web-server/servlet/web"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._clear-continuation-table!))" class="RktValLink" pltdoc="x">clear-continuation-table!</a></span></span><span class="RktPn"></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/void.html#(def._((quote._~23~25kernel)._void~3f))" class="RktValLink" pltdoc="x">void?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Calls the servlet&rsquo;s manager&rsquo;s <span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._clear-continuation-table!))" class="RktValLink" pltdoc="x">clear-continuation-table!</a></span> function. Normally, this deletes all the previously
captured continuations.</div></p></div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><table cellspacing="0" class="prototype"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/web..rkt)._with-errors-to-browser))"></a><span title="Provided from: web-server/servlet/web"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._with-errors-to-browser))" class="RktValLink" pltdoc="x">with-errors-to-browser</a></span></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">send/finish-or-back</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">thunk</span><span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="../reference/data-structure-contracts.html#(form._((lib._racket/contract/private/misc..rkt)._any))" class="RktStxLink" pltdoc="x">any</a></span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">send/finish-or-back</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/request-structs..rkt)._request~3f))" class="RktValLink" pltdoc="x">request?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">thunk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(form._((lib._racket/contract/private/misc..rkt)._any))" class="RktStxLink" pltdoc="x">any</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Calls <span class="RktVar">thunk</span> with an exception handler that generates an HTML error page
and calls <span class="RktVar">send/finish-or-back</span>.</div></p></div><div class="SIntrapara"><p><div class="SIntrapara">Example:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._with-errors-to-browser))" class="RktValLink" pltdoc="x">with-errors-to-browser</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/back))" class="RktValLink" pltdoc="x">send/back</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/generic-numbers.html#(def._((quote._~23~25kernel)._/))" class="RktValLink" pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">get-number</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">request-number</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p></div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/web..rkt)._adjust-timeout!))"></a><span title="Provided from: web-server/servlet/web"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._adjust-timeout!))" class="RktValLink" pltdoc="x">adjust-timeout!</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">t</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/void.html#(def._((quote._~23~25kernel)._void~3f))" class="RktValLink" pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">t</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Calls the servlet&rsquo;s manager&rsquo;s <span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._adjust-timeout!))" class="RktValLink" pltdoc="x">adjust-timeout!</a></span> function.</div></p></div><div class="SIntrapara"><span style="font-weight: bold">Warning: </span>This is deprecated and will be removed in a future release.</div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/web..rkt)._continuation-url~3f))"></a><span title="Provided from: web-server/servlet/web"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._continuation-url~3f))" class="RktValLink" pltdoc="x">continuation-url?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">u</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._false/c))" class="RktValLink" pltdoc="x">false/c</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._list/c))" class="RktValLink" pltdoc="x">list/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">u</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../net/url.html#(def._((lib._net/url-structs..rkt)._url~3f))" class="RktValLink" pltdoc="x">url?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Checks if <span class="RktVar">u</span> is a URL that refers to a continuation, if so
returns the instance id, continuation id, and nonce.</div></p></div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><a name="(def._((lib._web-server/servlet/web..rkt)._servlet-prompt))"></a><span title="Provided from: web-server/servlet/web"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._servlet-prompt))" class="RktValLink" pltdoc="x">servlet-prompt</a></span></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/cont.html#(def._((quote._~23~25kernel)._continuation-prompt-tag~3f))" class="RktValLink" pltdoc="x">continuation-prompt-tag?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">The tag used for Web interaction continuation capture.</div></p></div></p><h4>2.4<tt>&nbsp;</tt><a name="(part._web-cells)"></a><a name="(mod-path._web-server/servlet/web-cells)"></a>Web Cells</h4><p><div class="SIntrapara"><table cellspacing="0" class="defmodule"><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="RktStxLink" pltdoc="x">require</a></span><span class="stt"> </span><a href="#(mod-path._web-server/servlet/web-cells)" class="RktModLink" pltdoc="x"><span class="RktSym">web-server/servlet/web-cells</span></a><span class="RktPn">)</span></td></tr></table></div><div class="SIntrapara">The
<a href="#(mod-path._web-server/servlet/web-cells)" class="RktModLink" pltdoc="x"><span class="RktSym">web-server/servlet/web-cells</span></a> library provides the
interface to Web cells.</div><div class="SIntrapara">A Web cell is a kind of state defined relative to the <span style="font-style: italic">frame tree</span>.
The frame-tree is a mirror of the user&rsquo;s browsing session. Every time a
continuation is invoked, a new frame (called the <span style="font-style: italic">current frame</span>) is
created as a child of the current frame when the continuation was captured.</div><div class="SIntrapara">You should use Web cells if you want an effect to be encapsulated in all
interactions linked from (in a transitive sense) the HTTP response being
generated. For more information on their semantics, consult the paper
<a href="http://www.cs.brown.edu/~sk/Publications/Papers/Published/mk-int-safe-state-web/">"Interaction-Safe State for the Web"</a>.</div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/web-cells..rkt)._web-cell~3f))"></a><span title="Provided from: web-server/servlet/web-cells"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web-cells..rkt)._web-cell~3f))" class="RktValLink" pltdoc="x">web-cell?</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/booleans.html#(def._((quote._~23~25kernel)._boolean~3f))" class="RktValLink" pltdoc="x">boolean?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Determines if <span class="RktVar">v</span> is a web-cell.</div></p></div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/web-cells..rkt)._make-web-cell))"></a><span title="Provided from: web-server/servlet/web-cells"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web-cells..rkt)._make-web-cell))" class="RktValLink" pltdoc="x">make-web-cell</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web-cells..rkt)._web-cell~3f))" class="RktValLink" pltdoc="x">web-cell?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Creates a web-cell with a default value of <span class="RktVar">v</span>.</div></p></div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/web-cells..rkt)._web-cell-ref))"></a><span title="Provided from: web-server/servlet/web-cells"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web-cells..rkt)._web-cell-ref))" class="RktValLink" pltdoc="x">web-cell-ref</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">wc</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">wc</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web-cells..rkt)._web-cell~3f))" class="RktValLink" pltdoc="x">web-cell?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Looks up the value of <span class="RktVar">wc</span> found in the nearest
frame.</div></p></div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/servlet/web-cells..rkt)._web-cell-shadow))"></a><span title="Provided from: web-server/servlet/web-cells"><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web-cells..rkt)._web-cell-shadow))" class="RktValLink" pltdoc="x">web-cell-shadow</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">wc</span><span class="hspace">&nbsp;</span><span class="RktVar">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/void.html#(def._((quote._~23~25kernel)._void))" class="RktValLink" pltdoc="x">void</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">wc</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web-cells..rkt)._web-cell~3f))" class="RktValLink" pltdoc="x">web-cell?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">v</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Binds <span class="RktVar">wc</span> to <span class="RktVar">v</span> in the current frame, shadowing any
other bindings to <span class="RktVar">wc</span> in the current frame.</div></p></div><div class="SIntrapara"><p><div class="SIntrapara">Below is an extended example that demonstrates how Web cells allow
the creation of reusable Web abstractions without requiring global
transformations of the program into continuation or store passing style.
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" class="RktBlk"><tr><td><a href="../guide/Module_Syntax.html#(part._hash-lang)" class="RktModLink" pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="run.html#(mod-path._web-server/insta)" class="RktModLink" pltdoc="x"><span class="RktSym">web-server/insta</span></a></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">start</span><span class="hspace">&nbsp;</span><span class="RktSym">initial-request</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">counter1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-counter</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">counter2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-counter</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">include1</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">include-counter</span><span class="hspace">&nbsp;</span><span class="RktSym">counter1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">include2</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">include-counter</span><span class="hspace">&nbsp;</span><span class="RktSym">counter2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._send/suspend/dispatch))" class="RktValLink" pltdoc="x">send/suspend/dispatch</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">embed/url</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http.html#(def._((lib._web-server/http/xexpr..rkt)._response/xexpr))" class="RktValLink" pltdoc="x">response/xexpr</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">`</span><span class="RktVal">(</span><span class="RktVal">html</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">body</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">h2</span><span class="hspace">&nbsp;</span><span class="RktVal">"Double Counters"</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">div</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">h3</span><span class="hspace">&nbsp;</span><span class="RktVal">"First"</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">,</span><span class="RktPn">(</span><span class="RktSym">include1</span><span class="hspace">&nbsp;</span><span class="RktSym">embed/url</span><span class="RktPn">)</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">div</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">h3</span><span class="hspace">&nbsp;</span><span class="RktVal">"Second"</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">,</span><span class="RktPn">(</span><span class="RktSym">include2</span><span class="hspace">&nbsp;</span><span class="RktSym">embed/url</span><span class="RktPn">)</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">make-counter</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web-cells..rkt)._make-web-cell))" class="RktValLink" pltdoc="x">make-web-cell</a></span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">include-counter</span><span class="hspace">&nbsp;</span><span class="RktSym">a-counter</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/cont.html#(def._((quote._~23~25kernel)._call-with-current-continuation))" class="RktValLink" pltdoc="x">call-with-current-continuation</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/lambda.html#(form._((lib._racket/private/base..rkt)._~ce~bb))" class="RktStxLink" pltdoc="x">&#955;</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">k</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/let.html#(form._((lib._racket/private/letstx-scheme..rkt)._let))" class="RktStxLink" pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktSym">loop</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">k</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">embed/url</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">`</span><span class="RktVal">(</span><span class="RktVal">div</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">h3</span><span class="hspace">&nbsp;</span><span class="RktRdr">,</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/generic-numbers.html#(def._((quote._~23~25kernel)._number-~3estring))" class="RktValLink" pltdoc="x">number-&gt;string</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web-cells..rkt)._web-cell-ref))" class="RktValLink" pltdoc="x">web-cell-ref</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a-counter</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">(</span><span class="RktVal">a</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">[</span><span class="RktVal">href</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">,</span><span class="RktPn">(</span><span class="RktSym">embed/url</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="RktStxLink" pltdoc="x">_</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define.html#(form._((lib._racket/private/base..rkt)._define))" class="RktStxLink" pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">last</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web-cells..rkt)._web-cell-ref))" class="RktValLink" pltdoc="x">web-cell-ref</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a-counter</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web-cells..rkt)._web-cell-shadow))" class="RktValLink" pltdoc="x">web-cell-shadow</a></span><span class="hspace">&nbsp;</span><span class="RktSym">a-counter</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/generic-numbers.html#(def._((quote._~23~25kernel)._add1))" class="RktValLink" pltdoc="x">add1</a></span><span class="hspace">&nbsp;</span><span class="RktSym">last</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">loop</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktVal">]</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"+"</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/web..rkt)._servlet-prompt))" class="RktValLink" pltdoc="x">servlet-prompt</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p></div></p><h4>2.5<tt>&nbsp;</tt><a name="(part._managers)"></a>Continuation Managers</h4><p>Since Racket servlets store their continuations on the server, they take
up memory on the server. Furthermore, garbage collection can not be used
to free this memory, because there are roots outside the system: users&rsquo;
browsers, bookmarks, brains, and notebooks. Therefore, some other strategy
must be used if memory usage is to be controlled. This functionality is
pluggable through the manager interface.</p><h5>2.5.1<tt>&nbsp;</tt><a name="(part._manager)"></a><a name="(mod-path._web-server/managers/manager)"></a>General</h5><p><div class="SIntrapara"><table cellspacing="0" class="defmodule"><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="RktStxLink" pltdoc="x">require</a></span><span class="stt"> </span><a href="#(mod-path._web-server/managers/manager)" class="RktModLink" pltdoc="x"><span class="RktSym">web-server/managers/manager</span></a><span class="RktPn">)</span></td></tr></table></div><div class="SIntrapara">This module defines the manager interface. It is required by
the users and implementers of managers.</div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><table cellspacing="0"><colgroup><col width="0*" /><col width="0*" /><col width="0*" /><col width="0*" /><col /></colgroup><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define-struct.html#(form._((lib._racket/private/base..rkt)._struct))" class="RktStxLink" pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="nobreak"><a name="(def._((lib._web-server/managers/manager..rkt)._manager-continuation-peek))"></a><a name="(def._((lib._web-server/managers/manager..rkt)._manager-continuation-lookup))"></a><a name="(def._((lib._web-server/managers/manager..rkt)._manager-continuation-store!))"></a><a name="(def._((lib._web-server/managers/manager..rkt)._manager-clear-continuations!))"></a><a name="(def._((lib._web-server/managers/manager..rkt)._manager-adjust-timeout!))"></a><a name="(def._((lib._web-server/managers/manager..rkt)._manager-create-instance))"></a><a name="(def._((lib._web-server/managers/manager..rkt)._make-manager))"></a><a name="(def._((lib._web-server/managers/manager..rkt)._manager~3f))"></a><a name="(def._((lib._web-server/managers/manager..rkt)._struct~3amanager))"></a><a name="(def._((lib._web-server/managers/manager..rkt)._manager))"></a><span title="Provided from: web-server/managers/manager"><span class="RktSym"><a href="#(def._((lib._web-server/managers/manager..rkt)._manager))" class="RktValLink" pltdoc="x">manager</a></span></span></span></td><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span></td><td><span class="nobreak"><span class="RktSym">create-instance</span></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">adjust-timeout!</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">clear-continuations!</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">continuation-store!</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">continuation-lookup</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym">continuation-peek</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td colspan="3"><span class="RktPn">#:extra-constructor-name</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/managers/manager..rkt)._make-manager))" class="RktValLink" pltdoc="x">make-manager</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">create-instance</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/void.html#(def._((quote._~23~25kernel)._void))" class="RktValLink" pltdoc="x">void</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">adjust-timeout!</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/void.html#(def._((quote._~23~25kernel)._void))" class="RktValLink" pltdoc="x">void</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">clear-continuations!</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/void.html#(def._((quote._~23~25kernel)._void))" class="RktValLink" pltdoc="x">void</a></span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktSym">continuation-store!</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._false/c))" class="RktValLink" pltdoc="x">false/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">request?</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._list/c))" class="RktValLink" pltdoc="x">list/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">continuation-lookup</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">continuation-peek</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._any/c))" class="RktValLink" pltdoc="x">any/c</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara"><span class="RktSym">create-instance</span> is called to initialize a instance, to hold the
continuations of one servlet session. It is passed
a function to call when the instance is expired. It runs the id of the
instance.</div></p></div><div class="SIntrapara"><span class="RktSym">adjust-timeout!</span> is a to-be-deprecated function that takes an
instance-id and a number. It is specific to the timeout-based manager
and will be removed.</div><div class="SIntrapara"><span class="RktSym">clear-continuations!</span> expires all the continuations of an instance.</div><div class="SIntrapara"><span class="RktSym">continuation-store!</span> is given an instance-id, a continuation value,
and a function to include in the exception thrown if the continuation is
looked up and has been expired. The two numbers returned are a
continuation-id and a nonce.</div><div class="SIntrapara"><span class="RktSym">continuation-lookup</span> finds the continuation value associated with
the instance-id, continuation-id, and nonce triple it is given.</div><div class="SIntrapara"><span class="RktSym">continuation-peek</span> is identical to <span class="RktSym">continuation-lookup</span> except that
its use must not affect the resource management policy decisions on the instance or
continuation accessed. It is intended to be used by debuggers and benchmarks.</div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><table cellspacing="0"><colgroup><col width="0*" /><col width="0*" /><col width="0*" /><col width="0*" /><col /></colgroup><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define-struct.html#(form._((lib._racket/private/base..rkt)._struct))" class="RktStxLink" pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td colspan="3"><span class="nobreak"><a name="(def._((lib._web-server/managers/manager..rkt)._exn~3afail~3aservlet-manager~3ano-instance-expiration-handler))"></a><a name="(def._((lib._web-server/managers/manager..rkt)._make-exn~3afail~3aservlet-manager~3ano-instance))"></a><a name="(def._((lib._web-server/managers/manager..rkt)._exn~3afail~3aservlet-manager~3ano-instance~3f))"></a><a name="(def._((lib._web-server/managers/manager..rkt)._struct~3aexn~3afail~3aservlet-manager~3ano-instance))"></a><a name="(def._((lib._web-server/managers/manager..rkt)._exn~3afail~3aservlet-manager~3ano-instance))"></a><span title="Provided from: web-server/managers/manager"><span class="RktSym"><a href="#(def._((lib._web-server/managers/manager..rkt)._exn~3afail~3aservlet-manager~3ano-instance))" class="RktValLink" pltdoc="x">exn:fail:servlet-manager:no-instance</a></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/exns.html#(def._((lib._racket/private/base..rkt)._exn~3afail))" class="RktValLink" pltdoc="x">exn:fail</a></span></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span></td><td><span class="nobreak"><span class="RktSym">expiration-handler</span><span class="RktPn">)</span></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td colspan="3"><span class="RktPn">#:extra-constructor-name</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td colspan="3"><span class="RktSym"><a href="#(def._((lib._web-server/managers/manager..rkt)._make-exn~3afail~3aservlet-manager~3ano-instance))" class="RktValLink" pltdoc="x">make-exn:fail:servlet-manager:no-instance</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktSym">expiration-handler</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._false/c))" class="RktValLink" pltdoc="x">false/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">request?</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">This exception should be thrown by a manager when an instance is looked
up that does not exist.</div></p></div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><table cellspacing="0"><colgroup><col width="0*" /><col width="0*" /><col width="0*" /><col width="0*" /><col /></colgroup><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/define-struct.html#(form._((lib._racket/private/base..rkt)._struct))" class="RktStxLink" pltdoc="x">struct</a></span></td><td><span class="hspace">&nbsp;</span></td><td colspan="3"><span class="nobreak"><a name="(def._((lib._web-server/managers/manager..rkt)._exn~3afail~3aservlet-manager~3ano-continuation-expiration-handler))"></a><a name="(def._((lib._web-server/managers/manager..rkt)._make-exn~3afail~3aservlet-manager~3ano-continuation))"></a><a name="(def._((lib._web-server/managers/manager..rkt)._exn~3afail~3aservlet-manager~3ano-continuation~3f))"></a><a name="(def._((lib._web-server/managers/manager..rkt)._struct~3aexn~3afail~3aservlet-manager~3ano-continuation))"></a><a name="(def._((lib._web-server/managers/manager..rkt)._exn~3afail~3aservlet-manager~3ano-continuation))"></a><span title="Provided from: web-server/managers/manager"><span class="RktSym"><a href="#(def._((lib._web-server/managers/manager..rkt)._exn~3afail~3aservlet-manager~3ano-continuation))" class="RktValLink" pltdoc="x">exn:fail:servlet-manager:no-continuation</a></span></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/exns.html#(def._((lib._racket/private/base..rkt)._exn~3afail))" class="RktValLink" pltdoc="x">exn:fail</a></span></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span></td><td><span class="nobreak"><span class="RktSym">expiration-handler</span><span class="RktPn">)</span></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td colspan="3"><span class="RktPn">#:extra-constructor-name</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td colspan="3"><span class="RktSym"><a href="#(def._((lib._web-server/managers/manager..rkt)._make-exn~3afail~3aservlet-manager~3ano-continuation))" class="RktValLink" pltdoc="x">make-exn:fail:servlet-manager:no-continuation</a></span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktSym">expiration-handler</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._false/c))" class="RktValLink" pltdoc="x">false/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">request?</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">This exception should be thrown by a manager when a continuation is
looked up that does not exist.</div></p></div></p><h5>2.5.2<tt>&nbsp;</tt><a name="(part._none)"></a><a name="(mod-path._web-server/managers/none)"></a>No Continuations</h5><p><div class="SIntrapara"><table cellspacing="0" class="defmodule"><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="RktStxLink" pltdoc="x">require</a></span><span class="stt"> </span><a href="#(mod-path._web-server/managers/none)" class="RktModLink" pltdoc="x"><span class="RktSym">web-server/managers/none</span></a><span class="RktPn">)</span></td></tr></table></div><div class="SIntrapara">This module defines a manager constructor:</div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/managers/none..rkt)._create-none-manager))"></a><span title="Provided from: web-server/managers/none"><span class="RktSym"><a href="#(def._((lib._web-server/managers/none..rkt)._create-none-manager))" class="RktValLink" pltdoc="x">create-none-manager</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">instance-expiration-handler</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/managers/manager..rkt)._manager~3f))" class="RktValLink" pltdoc="x">manager?</a></span></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">instance-expiration-handler</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._false/c))" class="RktValLink" pltdoc="x">false/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">request?</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">This manager does not actually store any continuation or instance data.
You could use it if you know your servlet does not use the continuation
capturing functions and want the server to not allocate meta-data
structures for each instance.</div></p></div><div class="SIntrapara">If you <span style="font-style: italic">do</span> use a continuation capturing function, the continuation is
simply not stored. If the URL is visited, the <span class="RktVar">instance-expiration-handler</span>
is called with the request.</div><div class="SIntrapara">If you are considering using this manager, also consider using the
Web Language. (See <a href="stateless.html" pltdoc="x">Stateless Servlets</a>.)</div></p><h5>2.5.3<tt>&nbsp;</tt><a name="(part._timeouts)"></a><a name="(mod-path._web-server/managers/timeouts)"></a>Timeouts</h5><p><div class="SIntrapara"><table cellspacing="0" class="defmodule"><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="RktStxLink" pltdoc="x">require</a></span><span class="stt"> </span><a href="#(mod-path._web-server/managers/timeouts)" class="RktModLink" pltdoc="x"><span class="RktSym">web-server/managers/timeouts</span></a><span class="RktPn">)</span></td></tr></table></div><div class="SIntrapara">This module defines a manager constructor:</div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><table cellspacing="0" class="prototype"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/managers/timeouts..rkt)._create-timeout-manager))"></a><span title="Provided from: web-server/managers/timeouts"><span class="RktSym"><a href="#(def._((lib._web-server/managers/timeouts..rkt)._create-timeout-manager))" class="RktValLink" pltdoc="x">create-timeout-manager</a></span></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">instance-exp-handler</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">instance-timeout</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">continuation-timeout</span><span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="#(def._((lib._web-server/managers/manager..rkt)._manager~3f))" class="RktValLink" pltdoc="x">manager?</a></span></td></tr></table></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">instance-exp-handler</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._false/c))" class="RktValLink" pltdoc="x">false/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">request?</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">instance-timeout</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">continuation-timeout</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">Instances managed by this manager will be expired <span class="RktVar">instance-timeout</span>
seconds after the last time it is accessed. If an expired instance is
looked up, the <span class="RktSym"><a href="#(def._((lib._web-server/managers/manager..rkt)._exn~3afail~3aservlet-manager~3ano-instance))" class="RktValLink" pltdoc="x">exn:fail:servlet-manager:no-instance</a></span> exception
is thrown with <span class="RktVar">instance-exp-handler</span> as the expiration handler.</div></p></div><div class="SIntrapara">Continuations managed by this manager will be expired <span class="RktVar">continuation-timeout</span>
seconds after the last time it is accessed. If an expired continuation is looked
up, the <span class="RktSym"><a href="#(def._((lib._web-server/managers/manager..rkt)._exn~3afail~3aservlet-manager~3ano-continuation))" class="RktValLink" pltdoc="x">exn:fail:servlet-manager:no-continuation</a></span> exception
is thrown with <span class="RktVar">instance-exp-handler</span> as the expiration handler, if
no expiration-handler was passed to <span class="RktSym">continuation-store!</span>.</div><div class="SIntrapara"><span class="RktSym">adjust-timeout!</span> corresponds to <span class="RktSym">reset-timer!</span> on the timer
responsible for the servlet instance.</div><div class="SIntrapara">This manager has been found to be... problematic... in large-scale
deployments of the Web Server .</div></p><h5>2.5.4<tt>&nbsp;</tt><a name="(part._lru)"></a><a name="(mod-path._web-server/managers/lru)"></a>LRU</h5><p><div class="SIntrapara"><table cellspacing="0" class="defmodule"><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/require.html#(form._((lib._racket/private/base..rkt)._require))" class="RktStxLink" pltdoc="x">require</a></span><span class="stt"> </span><a href="#(mod-path._web-server/managers/lru)" class="RktModLink" pltdoc="x"><span class="RktSym">web-server/managers/lru</span></a><span class="RktPn">)</span></td></tr></table></div><div class="SIntrapara">This module defines a manager constructor:</div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><table cellspacing="0" class="prototype"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/managers/lru..rkt)._create-.L.R.U-manager))"></a><span title="Provided from: web-server/managers/lru"><span class="RktSym"><a href="#(def._((lib._web-server/managers/lru..rkt)._create-.L.R.U-manager))" class="RktValLink" pltdoc="x">create-LRU-manager</a></span></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">instance-expiration-handler</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">check-interval</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">collect-interval</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">collect?</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span>[</td><td><span class="RktPn">#:initial-count</span><span class="hspace">&nbsp;</span><span class="RktVar">initial-count</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">#:inform-p</span><span class="hspace">&nbsp;</span><span class="RktVar">inform-p</span>]<span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td><td>&rarr;</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktSym"><a href="#(def._((lib._web-server/managers/manager..rkt)._manager~3f))" class="RktValLink" pltdoc="x">manager?</a></span></td></tr></table></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">instance-expiration-handler</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._false/c))" class="RktValLink" pltdoc="x">false/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">request?</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">check-interval</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._integer~3f))" class="RktValLink" pltdoc="x">integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">collect-interval</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._integer~3f))" class="RktValLink" pltdoc="x">integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">collect?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/booleans.html#(def._((quote._~23~25kernel)._boolean~3f))" class="RktValLink" pltdoc="x">boolean?</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">initial-count</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._integer~3f))" class="RktValLink" pltdoc="x">integer?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktVal">1</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">inform-p</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._integer~3f))" class="RktValLink" pltdoc="x">integer?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/void.html#(def._((quote._~23~25kernel)._void))" class="RktValLink" pltdoc="x">void</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="RktStxLink" pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/void.html#(def._((quote._~23~25kernel)._void))" class="RktValLink" pltdoc="x">void</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Instances managed by this manager will be expired if there are no
continuations associated with them, after the instance is unlocked.
If an expired instance is looked up, the
<span class="RktSym"><a href="#(def._((lib._web-server/managers/manager..rkt)._exn~3afail~3aservlet-manager~3ano-instance))" class="RktValLink" pltdoc="x">exn:fail:servlet-manager:no-instance</a></span> exception
is thrown with <span class="RktSym">instance-exp-handler</span> as the expiration handler.</div></p></div><div class="SIntrapara">Continuations managed by this manager are given a "Life Count" of
<span class="RktVar">initial-count</span> initially. If an expired continuation is looked
up, the <span class="RktSym"><a href="#(def._((lib._web-server/managers/manager..rkt)._exn~3afail~3aservlet-manager~3ano-continuation))" class="RktValLink" pltdoc="x">exn:fail:servlet-manager:no-continuation</a></span> exception
is thrown with <span class="RktSym">instance-exp-handler</span> as the expiration handler, if
no expiration-handler was passed to <span class="RktSym">continuation-store!</span>.</div><div class="SIntrapara">Every <span class="RktVar">check-interval</span> seconds <span class="RktVar">collect?</span> is called to determine
if the collection routine should be run. Every <span class="RktVar">collect-interval</span> seconds
the collection routine is run.</div><div class="SIntrapara">Every time the collection routine runs, the "Life Count" of every
continuation is decremented by <span class="RktVal">1</span>. If a continuation&rsquo;s count
reaches <span class="RktVal">0</span>, it is expired. The <span class="RktVar">inform-p</span> function
is called if any continuations are expired, with the number of
continuations expired.</div><div class="SIntrapara">The recommended usage of this manager is codified as the following function:</div><div class="SIntrapara"><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><table cellspacing="0" class="prototype"><tr><td><span class="RktPn">(</span><a name="(def._((lib._web-server/managers/lru..rkt)._make-threshold-.L.R.U-manager))"></a><span title="Provided from: web-server/managers/lru"><span class="RktSym"><a href="#(def._((lib._web-server/managers/lru..rkt)._make-threshold-.L.R.U-manager))" class="RktValLink" pltdoc="x">make-threshold-LRU-manager</a></span></span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">instance-expiration-handler</span></td><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td><td><span class="hspace">&nbsp;</span></td><td><span class="RktVar">memory-threshold</span><span class="RktPn">)</span></td><td><span class="hspace">&nbsp;</span></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/managers/manager..rkt)._manager~3f))" class="RktValLink" pltdoc="x">manager?</a></span></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">instance-expiration-handler</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._false/c))" class="RktValLink" pltdoc="x">false/c</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">request?</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktSym"><a href="../reference/function-contracts.html#(form._((lib._racket/contract/base..rkt)._-~3e))" class="RktStxLink" pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktPn"> .</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="#(def._((lib._web-server/servlet/servlet-structs..rkt)._can-be-response~3f))" class="RktValLink" pltdoc="x">can-be-response?</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">memory-threshold</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/number-types.html#(def._((quote._~23~25kernel)._number~3f))" class="RktValLink" pltdoc="x">number?</a></span></td></tr></table></blockquote></div><div class="SIntrapara">This creates an LRU manager with the following behavior:
The memory limit is set to <span class="RktVar">memory-threshold</span> bytes. Continuations start with <span class="RktVal">24</span>
life points. Life points are deducted at the rate of one every <span class="RktVal">10</span> minutes, or one
every <span class="RktVal">5</span> seconds when the memory limit is exceeded. Hence the maximum life time for
a continuation is <span class="RktVal">4</span> hours, and the minimum is <span class="RktVal">2</span> minutes.</div></p></div><div class="SIntrapara">If the load on the server spikes&#8212;<wbr></wbr>as indicated by memory usage&#8212;<wbr></wbr>the server will quickly expire
continuations, until the memory is back under control. If the load
stays low, it will still efficiently expire old continuations.</div></p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;5.2.1&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }" /></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" pltdoc="x" onclick="return GotoPLTRoot(&quot;5.2.1&quot;);">top</a></span><span class="navright"><a href="run.html" title="backward to &quot;1 Running Web Servlets&quot;" pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Web Applications in Racket&quot;" pltdoc="x">up</a>&nbsp;&nbsp;<a href="stateless.html" title="forward to &quot;3 Stateless Servlets&quot;" pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>