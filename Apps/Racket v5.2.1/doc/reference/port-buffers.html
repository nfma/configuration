<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text-html; charset=utf-8" /><title>12.1.3&nbsp;Port Buffers and Positions</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default" /><link rel="stylesheet" type="text/css" href="extras.css" title="default" /><link rel="stylesheet" type="text/css" href="../racket.css" title="default" /><link rel="stylesheet" type="text/css" href="../scribble-style.css" title="default" /><script type="text/javascript" src="../scribble-common.js"></script></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist" style="margin-bottom: 1em;"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" pltdoc="x"><span style="font-weight: bold">The Racket Reference</span></a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="model.html" class="tocviewlink" pltdoc="x">Language Model</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="syntax.html" class="tocviewlink" pltdoc="x">Syntactic Forms</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="data.html" class="tocviewlink" pltdoc="x">Datatypes</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="structures.html" class="tocviewlink" pltdoc="x">Structures</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="mzlib_class.html" class="tocviewlink" pltdoc="x">Classes and Objects</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="mzlib_unit.html" class="tocviewlink" pltdoc="x">Units</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="contracts.html" class="tocviewlink" pltdoc="x">Contracts</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="match.html" class="tocviewlink" pltdoc="x">Pattern Matching</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="control.html" class="tocviewlink" pltdoc="x">Control Flow</a></td></tr><tr><td align="right">10&nbsp;</td><td><a href="concurrency.html" class="tocviewlink" pltdoc="x">Concurrency and Parallelism</a></td></tr><tr><td align="right">11&nbsp;</td><td><a href="Macros.html" class="tocviewlink" pltdoc="x">Macros</a></td></tr><tr><td align="right">12&nbsp;</td><td><a href="input-and-output.html" class="tocviewselflink" pltdoc="x">Input and Output</a></td></tr><tr><td align="right">13&nbsp;</td><td><a href="security.html" class="tocviewlink" pltdoc="x">Reflection and Security</a></td></tr><tr><td align="right">14&nbsp;</td><td><a href="os.html" class="tocviewlink" pltdoc="x">Operating System</a></td></tr><tr><td align="right">15&nbsp;</td><td><a href="memory.html" class="tocviewlink" pltdoc="x">Memory Management</a></td></tr><tr><td align="right">16&nbsp;</td><td><a href="unsafe.html" class="tocviewlink" pltdoc="x">Unsafe Operations</a></td></tr><tr><td align="right">17&nbsp;</td><td><a href="running.html" class="tocviewlink" pltdoc="x">Running Racket</a></td></tr><tr><td align="right"></td><td><a href="doc-bibliography.html" class="tocviewlink" pltdoc="x">Bibliography</a></td></tr><tr><td align="right"></td><td><a href="doc-index.html" class="tocviewlink" pltdoc="x">Index</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>12&nbsp;</td><td><a href="input-and-output.html" class="tocviewlink" pltdoc="x">Input and Output</a></td></tr></table><div class="tocviewsublist" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">12.1&nbsp;</td><td><a href="ports.html" class="tocviewselflink" pltdoc="x">Ports</a></td></tr><tr><td align="right">12.2&nbsp;</td><td><a href="Byte_and_String_Input.html" class="tocviewlink" pltdoc="x">Byte and String Input</a></td></tr><tr><td align="right">12.3&nbsp;</td><td><a href="Byte_and_String_Output.html" class="tocviewlink" pltdoc="x">Byte and String Output</a></td></tr><tr><td align="right">12.4&nbsp;</td><td><a href="Reading.html" class="tocviewlink" pltdoc="x">Reading</a></td></tr><tr><td align="right">12.5&nbsp;</td><td><a href="Writing.html" class="tocviewlink" pltdoc="x">Writing</a></td></tr><tr><td align="right">12.6&nbsp;</td><td><a href="pretty-print.html" class="tocviewlink" pltdoc="x">Pretty Printing</a></td></tr><tr><td align="right">12.7&nbsp;</td><td><a href="Reader_Extension.html" class="tocviewlink" pltdoc="x">Reader Extension</a></td></tr><tr><td align="right">12.8&nbsp;</td><td><a href="Printer_Extension.html" class="tocviewlink" pltdoc="x">Printer Extension</a></td></tr><tr><td align="right">12.9&nbsp;</td><td><a href="serialization.html" class="tocviewlink" pltdoc="x">Serialization</a></td></tr><tr><td align="right">12.10&nbsp;</td><td><a href="fasl.html" class="tocviewlink" pltdoc="x">Fast-<wbr></wbr>Load Serialization</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_2&quot;);">&#9660;</a></td><td>12.1&nbsp;</td><td><a href="ports.html" class="tocviewlink" pltdoc="x">Ports</a></td></tr></table><div class="tocviewsublistbottom" style="display: block;" id="tocview_2"><table cellspacing="0" cellpadding="0"><tr><td align="right">12.1.1&nbsp;</td><td><a href="encodings.html" class="tocviewlink" pltdoc="x">Encodings and Locales</a></td></tr><tr><td align="right">12.1.2&nbsp;</td><td><a href="port-ops.html" class="tocviewlink" pltdoc="x">Managing Ports</a></td></tr><tr><td align="right">12.1.3&nbsp;</td><td><a href="" class="tocviewselflink" pltdoc="x">Port Buffers and Positions</a></td></tr><tr><td align="right">12.1.4&nbsp;</td><td><a href="linecol.html" class="tocviewlink" pltdoc="x">Counting Positions, Lines, and Columns</a></td></tr><tr><td align="right">12.1.5&nbsp;</td><td><a href="file-ports.html" class="tocviewlink" pltdoc="x">File Ports</a></td></tr><tr><td align="right">12.1.6&nbsp;</td><td><a href="stringport.html" class="tocviewlink" pltdoc="x">String Ports</a></td></tr><tr><td align="right">12.1.7&nbsp;</td><td><a href="pipeports.html" class="tocviewlink" pltdoc="x">Pipes</a></td></tr><tr><td align="right">12.1.8&nbsp;</td><td><a href="portstructs.html" class="tocviewlink" pltdoc="x">Structures as Ports</a></td></tr><tr><td align="right">12.1.9&nbsp;</td><td><a href="customport.html" class="tocviewlink" pltdoc="x">Custom Ports</a></td></tr><tr><td align="right">12.1.10&nbsp;</td><td><a href="port-lib.html" class="tocviewlink" pltdoc="x">More Port Constructors, Procedures, and Events</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><a href="#(def._((quote._~23~25kernel)._flush-output))" class="tocsublink" pltdoc="x"><span title="Provided from: racket/base, racket"><span class="RktSym"><span class="RktValLink">flush-<wbr></wbr>output</span></span></span></a></td></tr><tr><td><a href="#(def._((quote._~23~25kernel)._file-stream-buffer-mode))" class="tocsublink" pltdoc="x"><span title="Provided from: racket/base, racket"><span class="RktSym"><span class="RktValLink">file-<wbr></wbr>stream-<wbr></wbr>buffer-<wbr></wbr>mode</span></span></span></a></td></tr><tr><td><a href="#(def._((quote._~23~25kernel)._file-position))" class="tocsublink" pltdoc="x"><span title="Provided from: racket/base, racket"><span class="RktSym"><span class="RktValLink">file-<wbr></wbr>position</span></span></span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;5.2.1&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }" /></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" pltdoc="x" onclick="return GotoPLTRoot(&quot;5.2.1&quot;);">top</a></span><span class="navright"><a href="port-ops.html" title="backward to &quot;12.1.2 Managing Ports&quot;" pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="ports.html" title="up to &quot;12.1 Ports&quot;" pltdoc="x">up</a>&nbsp;&nbsp;<a href="linecol.html" title="forward to &quot;12.1.4 Counting Positions, Lines, and Columns&quot;" pltdoc="x">next &rarr;</a></span>&nbsp;</div><h5>12.1.3<tt>&nbsp;</tt><a name="(part._port-buffers)"></a>Port Buffers and Positions</h5><p>Some ports&#8212;<wbr></wbr>especially those that read from and write to files&#8212;<wbr></wbr>are
internally buffered:</p><ul><li><p>An input port is typically block-buffered by default, which
means that on any read, the buffer is filled with
immediately-available bytes to speed up future reads. Thus, if
a file is modified between a pair of reads to the file, the
second read can produce stale data. Calling
<span class="RktSym"><a href="#(def._((quote._~23~25kernel)._file-position))" class="RktValLink" pltdoc="x">file-position</a></span> to set an input port&rsquo;s file position
flushes its buffer.</p></li><li><p>An output port is typically block-buffered by default, though
a terminal output port is line-buffered, and the initial error
output port is unbuffered.  An output buffer is filled with a
sequence of written bytes to be committed as a group, either
when the buffer is full (in block mode), when a newline is
written (in line mode), when the port is closed via
<span class="RktSym"><a href="port-ops.html#(def._((quote._~23~25kernel)._close-output-port))" class="RktValLink" pltdoc="x">close-output-port</a></span>, or when a flush is explicitly
requested via a procedure like <span class="RktSym"><a href="#(def._((quote._~23~25kernel)._flush-output))" class="RktValLink" pltdoc="x">flush-output</a></span>.</p></li></ul><p>If a port supports buffering, its buffer mode can be changed via
<span class="RktSym"><a href="#(def._((quote._~23~25kernel)._file-stream-buffer-mode))" class="RktValLink" pltdoc="x">file-stream-buffer-mode</a></span> (even if the port is not a
<a href="file-ports.html#(tech._file._stream._port)" class="techoutside" pltdoc="x"><span class="techinside">file-stream port</span></a>).</p><p>For an input port, peeking always places peeked bytes into the port&rsquo;s
buffer, even when the port&rsquo;s buffer mode is <span class="RktVal">'</span><span class="RktVal">none</span>;
furthermore, on some platforms, testing the port for input (via
<span class="RktSym"><a href="Byte_and_String_Input.html#(def._((quote._~23~25kernel)._char-ready~3f))" class="RktValLink" pltdoc="x">char-ready?</a></span> or <span class="RktSym"><a href="sync.html#(def._((quote._~23~25kernel)._sync))" class="RktValLink" pltdoc="x">sync</a></span>) may be implemented with a
peek. If an input port&rsquo;s buffer mode is <span class="RktVal">'</span><span class="RktVal">none</span>, then at most
one byte is read for <span class="RktSym"><a href="Byte_and_String_Input.html#(def._((quote._~23~25kernel)._read-bytes-avail!*))" class="RktValLink" pltdoc="x">read-bytes-avail!*</a></span>,
<span class="RktSym"><a href="Byte_and_String_Input.html#(def._((quote._~23~25kernel)._read-bytes-avail!))" class="RktValLink" pltdoc="x">read-bytes-avail!</a></span>, <span class="RktSym"><a href="Byte_and_String_Input.html#(def._((quote._~23~25kernel)._peek-bytes-avail!*))" class="RktValLink" pltdoc="x">peek-bytes-avail!*</a></span>, or
<span class="RktSym"><a href="Byte_and_String_Input.html#(def._((quote._~23~25kernel)._peek-bytes-avail!))" class="RktValLink" pltdoc="x">peek-bytes-avail!</a></span>; if any bytes are buffered in the port
(e.g., to satisfy a previous peek), the procedures may access multiple
buffered bytes, but no further bytes are read.</p><p>In addition, the initial current output and error ports are
automatically flushed when <span class="RktSym"><a href="Reading.html#(def._((quote._~23~25kernel)._read))" class="RktValLink" pltdoc="x">read</a></span>, <span class="RktSym"><a href="Byte_and_String_Input.html#(def._((quote._~23~25kernel)._read-line))" class="RktValLink" pltdoc="x">read-line</a></span>,
<span class="RktSym"><a href="Byte_and_String_Input.html#(def._((quote._~23~25kernel)._read-bytes))" class="RktValLink" pltdoc="x">read-bytes</a></span>, <span class="RktSym"><a href="Byte_and_String_Input.html#(def._((quote._~23~25kernel)._read-string))" class="RktValLink" pltdoc="x">read-string</a></span>, etc., are performed on the
initial standard input port; more precisely, flushing is performed by
the default port read handler (see <span class="RktSym"><a href="Reading.html#(def._((quote._~23~25kernel)._port-read-handler))" class="RktValLink" pltdoc="x">port-read-handler</a></span>).</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((quote._~23~25kernel)._flush-output))"></a><span title="Provided from: racket/base, racket"><span class="RktSym"><a href="#(def._((quote._~23~25kernel)._flush-output))" class="RktValLink" pltdoc="x">flush-output</a></span></span><span class="hspace">&nbsp;</span>[<span class="RktVar">out</span>]<span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="void.html#(def._((quote._~23~25kernel)._void~3f))" class="RktValLink" pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">out</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="port-ops.html#(def._((quote._~23~25kernel)._output-port~3f))" class="RktValLink" pltdoc="x">output-port?</a></span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="port-ops.html#(def._((quote._~23~25kernel)._current-output-port))" class="RktValLink" pltdoc="x">current-output-port</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara"><a name="(idx._(gentag._191._(lib._scribblings/reference/reference..scrbl)))"></a>Forces all buffered data in the given
output port to be physically written. Only <a href="file-ports.html#(tech._file._stream._port)" class="techoutside" pltdoc="x"><span class="techinside">file-stream ports</span></a>,
TCP ports, and custom ports (see <a href="customport.html" pltdoc="x">Custom Ports</a>) use
buffers; when called on a port without a buffer, <span class="RktSym"><a href="#(def._((quote._~23~25kernel)._flush-output))" class="RktValLink" pltdoc="x">flush-output</a></span>
has no effect.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((quote._~23~25kernel)._file-stream-buffer-mode))"></a><span title="Provided from: racket/base, racket"><span class="RktSym"><a href="#(def._((quote._~23~25kernel)._file-stream-buffer-mode))" class="RktValLink" pltdoc="x">file-stream-buffer-mode</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">port</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">none</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">line</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">block</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">port</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="port-ops.html#(def._((lib._racket/private/misc..rkt)._port~3f))" class="RktValLink" pltdoc="x">port?</a></span></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: racket/base, racket"><span class="RktSym"><a href="#(def._((quote._~23~25kernel)._file-stream-buffer-mode))" class="RktValLink" pltdoc="x">file-stream-buffer-mode</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">port</span><span class="hspace">&nbsp;</span><span class="RktVar">mode</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="void.html#(def._((quote._~23~25kernel)._void~3f))" class="RktValLink" pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">port</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="port-ops.html#(def._((lib._racket/private/misc..rkt)._port~3f))" class="RktValLink" pltdoc="x">port?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">mode</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">none</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">line</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">block</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Gets or sets the buffer mode for <span class="RktVar">port</span>, if
possible. <a href="file-ports.html#(tech._file._stream._port)" class="techoutside" pltdoc="x"><span class="techinside">File-stream ports</span></a> support setting the buffer mode,
TCP ports (see <a href="networking.html" pltdoc="x">Networking</a>) support setting and getting
the buffer mode, and custom ports (see <a href="customport.html" pltdoc="x">Custom Ports</a>) may
support getting and setting buffer modes.</div></p><p>If <span class="RktVar">mode</span> is provided, it must be one of
<a name="(idx._(gentag._192._(lib._scribblings/reference/reference..scrbl)))"></a><span class="RktVal">'</span><span class="RktVal">none</span>, <a name="(idx._(gentag._193._(lib._scribblings/reference/reference..scrbl)))"></a><span class="RktVal">'</span><span class="RktVal">line</span> (output only), or
<a name="(idx._(gentag._194._(lib._scribblings/reference/reference..scrbl)))"></a><span class="RktVal">'</span><span class="RktVal">block</span>, and the port&rsquo;s buffering is set
accordingly. If the port does not support setting the mode, the
<span class="RktSym"><a href="exns.html#(def._((lib._racket/private/base..rkt)._exn~3afail))" class="RktValLink" pltdoc="x">exn:fail</a></span> exception is raised.</p><p>If <span class="RktVar">mode</span> is not provided, the current mode is returned, or
<span class="RktVal">#f</span> is returned if the mode cannot be determined. If
<span class="RktSym">file-stream-port</span> is an input port and <span class="RktVar">mode</span> is
<span class="RktVal">'</span><span class="RktVal">line</span>, the <span class="RktSym"><a href="exns.html#(def._((lib._racket/private/base..rkt)._exn~3afail~3acontract))" class="RktValLink" pltdoc="x">exn:fail:contract</a></span> exception is raised.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" class="boxed RBoxed"><tr><td><span class="RktPn">(</span><a name="(def._((quote._~23~25kernel)._file-position))"></a><span title="Provided from: racket/base, racket"><span class="RktSym"><a href="#(def._((quote._~23~25kernel)._file-position))" class="RktValLink" pltdoc="x">file-position</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">port</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="number-types.html#(def._((quote._~23~25kernel)._exact-nonnegative-integer~3f))" class="RktValLink" pltdoc="x">exact-nonnegative-integer?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">port</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="port-ops.html#(def._((lib._racket/private/misc..rkt)._port~3f))" class="RktValLink" pltdoc="x">port?</a></span></td></tr><tr><td><span class="RktPn">(</span><span title="Provided from: racket/base, racket"><span class="RktSym"><a href="#(def._((quote._~23~25kernel)._file-position))" class="RktValLink" pltdoc="x">file-position</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">port</span><span class="hspace">&nbsp;</span><span class="RktVar">pos</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><a href="void.html#(def._((quote._~23~25kernel)._void~3f))" class="RktValLink" pltdoc="x">void?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">port</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><a href="port-ops.html#(def._((lib._racket/private/misc..rkt)._port~3f))" class="RktValLink" pltdoc="x">port?</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pos</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="data-structure-contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="number-types.html#(def._((quote._~23~25kernel)._exact-nonnegative-integer~3f))" class="RktValLink" pltdoc="x">exact-nonnegative-integer?</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="port-ops.html#(def._((quote._~23~25kernel)._eof-object~3f))" class="RktValLink" pltdoc="x">eof-object?</a></span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns or sets the current read/write position of <span class="RktVar">port</span>.</div></p><p>Calling <span class="RktSym"><a href="#(def._((quote._~23~25kernel)._file-position))" class="RktValLink" pltdoc="x">file-position</a></span> without a position on a port other
than a <a href="file-ports.html#(tech._file._stream._port)" class="techoutside" pltdoc="x"><span class="techinside">file-stream port</span></a> or <a href="stringport.html#(tech._string._port)" class="techoutside" pltdoc="x"><span class="techinside">string port</span></a>
returns the number of bytes that have
been read from that port if the position is known (see
<a href="linecol.html" pltdoc="x">Counting Positions, Lines, and Columns</a>), otherwise the <span class="RktSym"><a href="exns.html#(def._((lib._racket/private/base..rkt)._exn~3afail~3afilesystem))" class="RktValLink" pltdoc="x">exn:fail:filesystem</a></span> exception is raised.</p><p>For <a href="file-ports.html#(tech._file._stream._port)" class="techoutside" pltdoc="x"><span class="techinside">file-stream ports</span></a> and <a href="stringport.html#(tech._string._port)" class="techoutside" pltdoc="x"><span class="techinside">string ports</span></a>, the position-setting
variant sets the read/write position to <span class="RktVar">pos</span> relative to the
beginning of the file or (byte) string if <span class="RktVar">pos</span> is a number, or to the
current end of the file or (byte) string if <span class="RktVar">pos</span> is <span class="RktSym"><a href="port-ops.html#(def._((quote._~23~25kernel)._eof))" class="RktValLink" pltdoc="x">eof</a></span>. In
position-setting mode, <span class="RktSym"><a href="#(def._((quote._~23~25kernel)._file-position))" class="RktValLink" pltdoc="x">file-position</a></span> raises the
<span class="RktSym"><a href="exns.html#(def._((lib._racket/private/base..rkt)._exn~3afail~3acontract))" class="RktValLink" pltdoc="x">exn:fail:contract</a></span> exception for port kinds other than
<a href="file-ports.html#(tech._file._stream._port)" class="techoutside" pltdoc="x"><span class="techinside">file-stream ports</span></a> and <a href="stringport.html#(tech._string._port)" class="techoutside" pltdoc="x"><span class="techinside">string ports</span></a>. Furthermore, not all <a href="file-ports.html#(tech._file._stream._port)" class="techoutside" pltdoc="x"><span class="techinside">file-stream
ports</span></a> support setting the position; if <span class="RktSym"><a href="#(def._((quote._~23~25kernel)._file-position))" class="RktValLink" pltdoc="x">file-position</a></span> is
called with a position argument on such a <a href="file-ports.html#(tech._file._stream._port)" class="techoutside" pltdoc="x"><span class="techinside">file-stream port</span></a>, the
<span class="RktSym"><a href="exns.html#(def._((lib._racket/private/base..rkt)._exn~3afail~3afilesystem))" class="RktValLink" pltdoc="x">exn:fail:filesystem</a></span> exception is raised.</p><p>When <span class="RktSym"><a href="#(def._((quote._~23~25kernel)._file-position))" class="RktValLink" pltdoc="x">file-position</a></span> sets the position <span class="RktVar">pos</span> beyond the
current size of an output file or (byte) string, the file/string is enlarged
to size <span class="RktVar">pos</span> and the new region is filled with <span class="RktVal">0</span>
bytes.  If <span class="RktVar">pos</span> is beyond the end of an input file or (byte) string,
then reading thereafter returns <span class="RktSym"><a href="port-ops.html#(def._((quote._~23~25kernel)._eof))" class="RktValLink" pltdoc="x">eof</a></span> without changing the
port&rsquo;s position.</p><p>When changing the file position for an output port, the port is first
flushed if its buffer is not empty. Similarly, setting the position
for an input port clears the port&rsquo;s buffer (even if the new position
is the same as the old position). However, although input and output
ports produced by <span class="RktSym"><a href="file-ports.html#(def._((lib._racket/private/base..rkt)._open-input-output-file))" class="RktValLink" pltdoc="x">open-input-output-file</a></span> share the file
position, setting the position via one port does not flush the other
port&rsquo;s buffer.</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;5.2.1&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }" /></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" pltdoc="x" onclick="return GotoPLTRoot(&quot;5.2.1&quot;);">top</a></span><span class="navright"><a href="port-ops.html" title="backward to &quot;12.1.2 Managing Ports&quot;" pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="ports.html" title="up to &quot;12.1 Ports&quot;" pltdoc="x">up</a>&nbsp;&nbsp;<a href="linecol.html" title="forward to &quot;12.1.4 Counting Positions, Lines, and Columns&quot;" pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>